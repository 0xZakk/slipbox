- **Type:** #[[__ üü¶  Reference Note]] #[[üì• Inbox]] #[[üìù To Process]] | [[Blockchain]]
- **Source:** [[Hyperledger Fabric Documentation]] https://hyperledger-fabric.readthedocs.io/en/latest/test_network.html 
- **Project(s):** [[üì¶ Grokking Blockchain]] [[üì¶ Building Blockchain Applications with Hyperledger Fabric]] [[üì¶ Article: Setting up your computer for Hyperledger Fabric]]
- **Summary:** 
- **Highlights:**
    - [[üü® The Fabric test network]]
    - After you have downloaded the Hyperledger Fabric Docker images and samples, you can deploy a test network by using scripts that are provided in the fabric-samples repository. **You can use the test network to learn about Fabric by running nodes on your local machine.** More experienced developers can use the network to test their smart contracts and applications. ==**The network is meant to be used only as a tool for education and testing. It should not be used as a template for deploying a production network.**== The test network is being introduced in Fabric v2.0 as the long term replacement for the first-network sample.
    - The sample network deploys a Fabric network with Docker Compose. Because the nodes are isolated within a Docker Compose network, the test network is not configured to connect to other running fabric nodes.
    - **Bring up the test network** [[üü® Starting the Fabric test network]]
        - You can find the scripts to bring up the network in the `test-network` directory of the `fabric-samples` repository.
        - In this directory, you can find an annotated script, `network.sh`, that **stands
up a Fabric network using the Docker images on your local machine.**
        - You can run `./network.sh -h` to print the script help text
        - From inside the test-network directory, run the following command to remove
any containers or artifacts from any previous runs: `./network.sh down`
        - You can then bring up the network by issuing the following command: `./network.sh up`
        - This command creates a Fabric network that consists of two peer nodes, one
ordering node.
    - **The components of the test network**
        - After your test network is deployed, you can take some time to examine its
components.
        - Run the following command to list all of Docker containers that
are running on your machine. You should see the three nodes that were created by the network.sh script: `docker ps -a`
        - ==**Each node and user that interacts with a Fabric network needs to belong to an organization that is a network member.**==
        - ==**The group of organizations that are members of a Fabric network are often referred to as the consortium.**== [[üü® Blockchain Consortium]]
        - The test network has two consortium members, Org1 and Org2. **The network also includes one orderer organization that maintains the ordering service of the network.**
        - [Peers](https://hyperledger-fabric.readthedocs.io/en/latest/peers/peers.html) are the fundamental components of any Fabric network. ==**Peers store the blockchain ledger and validate transactions before they are committed to the ledger. Peers run the smart contracts that contain the business logic that is used to manage the assets on the blockchain ledger.**==
        - ==**Every peer in the network needs to belong to a member of the consortium.**== In the test network, each organization operates one peer each,  eer0.org1.example.com and peer0.org2.example.com.
        - Every Fabric network also includes an [ordering service](https://hyperledger-fabric.readthedocs.io/en/latest/orderer/ordering_service.html). While peers validate transactions and add blocks of transactions to the blockchain ledger, ==**they do not decide on the order of transactions or include them into new blocks**==. On a distributed network, peers may be running far away from each other and not have a common view of when a transaction was created. Coming to consensus on the order of transactions is a costly process that would create overhead for the peers.
        - ==**An ordering service allows peers to focus on validating transactions and committing them to the ledger.**== **After ordering nodes receive endorsed transactions from clients, they come to consensus on the order of transactions and then add them to blocks. The blocks are then distributed to peer nodes**, which add the blocks the blockchain ledger. **Ordering nodes also operate the system channel that defines the capabilities of a Fabric network**, such as how blocks are made and which version of Fabric that nodes can use. **The system channel defines which organizations are members of the consortium.**
        - **The sample network uses a single node Raft ordering service that is operated by the ordering organization.** You can see the ordering node running on your machine as `orderer.example.com`. **While the test network only uses a single node ordering service, a real network would have multiple ordering nodes, operated by one or multiple orderer organizations.** The different ordering nodes would use the Raft consensus algorithm to come to agreement on the order of transactions across the network.
    - **Creating a channel**
        - Now that we have peer and orderer nodes running on our machine, we can use the script to create a Fabric channel for transactions between Org1 and Org2. ==**Channels are a private layer of communication between specific network members. Channels can be used only by organizations that are invited to the channel, and are invisible to other members of the network.**== **Each channel has a separate blockchain ledger. Organizations that have been invited ‚Äújoin‚Äù their peers to the channel to store the channel ledger and validate the transactions on the channel.**
        - You can use the `network.sh` script to create a channel between Org1 and Org2 and join their peers to the channel. Run the following command to create a channel with the default name of mychannel: `./network.sh createChannel`
        - You can also use the channel flag to create a channel with custom name. As an example, the following command would create a channel named `channel1`: `./network.sh createChannel -c channel1`
        - The channel flag also allows you to create multiple channels by specifying
different channel names. After you create `mychannel` or `channel1`, you can use the command below to create a second channel named `channel2`: `./network.sh createChannel -c channel2`
        - If you want to bring up the network and create a channel in a single step, you
can use the up and `createChannel` modes together: `./network.sh up createChannel`
    - **Starting a chaincode on the channel**
        - After you have created a channel, you can start using [smart contracts](https://hyperledger-fabric.readthedocs.io/en/latest/smartcontract/smartcontract.html) to interact with the channel ledger. ==**Smart contracts contain the business logic that governs assets on the blockchain ledger.**== **Applications run by members of the network can invoke smart contracts to create assets on the ledger, as well as change and transfer those assets. Applications also query smart contracts to read data on the ledger.**
        - **To ensure that transactions are valid, transactions created using smart contracts typically need to be signed by multiple organizations to be committed to the channel ledger.** Multiple signatures are integral to the trust model of Fabric. **Requiring multiple endorsements for a transaction prevents one organization on a channel from tampering with the ledger on their peer or using business logic that was not agreed to.** ==**To sign a transaction, each organization needs to invoke and execute the smart contract on their peer, which then signs the output of the transaction.**== **If the output is consistent and has been signed by enough organizations, the transaction can be committed to the ledger.** The policy that specifies the set organizations on the channel that need to execute the smart contract is referred to as the endorsement policy, which is set for each chaincode as part of the chaincode definition.
        - In Fabric, ==**smart contracts are deployed on the network in packages referred to as chaincode.**== **A Chaincode is installed on the peers of an organization and then deployed to a channel, where it can then be used to endorse transactions and interact with the blockchain ledger.** Before a chaincode can be deployed to a channel, the members of the channel need to agree on a chaincode definition that establishes chaincode governance. When the required number of organizations agree, the chaincode definition can be committed to the channel, and the chaincode is ready to be used.
        - After you have used the `network.sh` to create a channel, you can start a
chaincode on the channel using the following command: `./network.sh deployCC`
        - The `deployCC` subcommand will install the **asset-transfer (basic)** chaincode on `peer0.org1.example.com` and `peer0.org2.example.com` and then deploy the chaincode on the channel specified using the channel flag (or `mychannel` if no channel is specified).  If you are deploying a chaincode for the first time, the script will install the chaincode dependencies. By default, The script installs the Go version of the asset-transfer (basic) chaincode. However, you can use the language flag, `-l`, to install the typescript or javascript versions of the chaincode. You can find the asset-transfer (basic) chaincode in the `asset-transfer-basic` folder of the `fabric-samples` directory. This folder contains sample chaincode that are provided as examples and used by tutorials to highlight Fabric features.
    - **Interacting with the network**
        - After you bring up the test network, you can use the `peer` CLI to interact with your network. The `peer` CLI allows you to invoke deployed smart contracts, update channels, or install and deploy new smart contracts from the CLI.
    - **Bringing down the network**
        - When you are finished using the test network, you can bring down the network with the following command:
        - `./network.sh down`
        - The command will stop and remove the node and chaincode containers, delete the organization crypto material, and remove the chaincode images from your Docker Registry. The command also removes the channel artifacts and docker volumes from previous runs, allowing you to run ./network.sh up again if you encountered any problems.
